# SPSS与线性方差

## 判定系数

$R^2=\frac{SSR}{SST}，\quad 0\leq R^2\leq 1$

$R_2度量了回归自变量x_1,.......x_{p-1}因变量Y的拟合程度的好坏$

$R^2值越大，表明Y与诸X有较大的相依关系$
$$
SST \quad= \quad SSE \quad + \quad SSR
$$

$$
SST=\sum_{i=1}^n(y_i-\overline{y})^2 
\quad 
SSE=\sum_{i=1}^{n}(y_i-\widehat{y_i})^2
\quad 
SSR=\sum_{i=1}^{n}{(\widehat{y_i}-\overline{y})^2}
$$

​                            总平方和                               残差平方和                        回归平方和

## 回归方程显著性的检验

正态线性回归模型：
$$
\begin{cases} 
\widehat{\alpha}=\overline{y}\\
\widehat{\beta}=(X_c^{'}X_c)^{-1}X_c^{'}y
\end{cases}
$$

$$
y_i=\beta_0+x_{11}\beta_1+......x_{i}\beta_{p-1}+e_i
$$

$$
e_i~N(0,\sigma^2),\quad i=1,2,......n
$$

检验假设：所有回归系数都等于0
$$
H:\quad\beta_1=......=\beta_{p-1}=0
$$
拒绝原假设:

则至少一个$\beta\neq0$,Y线性依赖于摸一个西边亮$X_{i}$,也有可能依赖于所有自变量$\quad X_1,......X_{p-1}$

接受原假设:

则所有$\beta_i=0$，相对误差而言，所有自变量对因变量Y的影响是不重要的

## 残差分析

残差向量：$\widehat{e}=y-X \widehat{\beta}$

第i个观测的残差：$\widehat{e_i}=y_i-x_i^{'} \widehat{\beta}$

拟合向量值：$\widehat{y}=X\widehat{\beta}$

第i个拟合值：$\widehat{y_i}=x_i^{'}\widehat{\beta}$





## SPSS 线性 Example

导入数据后，先检验线性回归的前提条件

线性（散点图，散点图矩阵）

独立性

正态性

方差齐性



##### spss绘制散点图

图形——旧对话框——散点图——矩阵分布（变量多的时候）——输入矩阵变量——确定

得到的散点图就可以大致看出自变量与因变量的关系，从而粗略的判断使用什么模型



##### spss线性回归

分析——回归——线性——导入自变量与因变量——方法（==一般选择输入，若选择输入的回归不理想，且变量很多的情况下，可以选择步进==）——统计（选择估计、德宾·沃森、模型拟合和共线性诊断）——图（Y选择*ZRESID  X选择\*ZPRED【用于方差齐性检验】，勾选直方图和正态概率图）

德宾·沃森：独立性诊断

共线性诊断：防止在变量较多的时候出现复线性。

注：自变量间趋势存在复共线性，直接采用多重回归得到的模型肯定是不可信的



==模型摘要==

**R的平方**越接近于1，说明**拟合度**越好，通常不能低于0.36

**德宾·沃森**值用来判断独立性，一般在0到4之间，但是越接近于2**独立性**越好



==直方图和P-P图==

可以判断是否是正态，以及**正态性**的检验



==散点图==

用于**方差齐性**分析，**回归标准化残差在一定的范围内**



##### ==判断完以上的拟合度、独立性、正态性、方差齐性，确认可以进行线性拟合后可进入回归方程的显著性分析==



==ANOVA==

**sig**值<0.05，说明回归方程存在统计学意义，即对应的回归系数不全为0



==系数==

B即为自变量的系数和常量，系数都不为零既可以拒绝原假设（原假设是全部的$\beta=0$）

Sig<0,05表示自变量对因变量有显著的影响

VIF方差膨胀因子<10,表明数据不存在共线性问题





## 单因素方差分析模型

用于检验模型的因素A的a个水平下的均值是否有差异

检验假设

$H_0:\mu_1=\mu_2=......=\mu_3$

$\alpha_i=\mu_i-\mu$

$H_0:\alpha_1=\alpha_2=......=\alpha_a=0$

$H_0被拒绝，则因素A的各水平效应之间有显著差异$

$SS_T=\sum_{i=1}^{a}\sum_{j=1}^{n_i}(y_{ij}-\overline{y})^2$

$\overline{y}=\frac{1}{n_ia}\sum_{i=1}^{a}\sum_{j=1}^{n_i}y_{ij}$

总的离差平方和简称总平方和，他反应全部试验数据之间的差异

#### Example

有三种小麦品种，每公顷产量数据如表所示，问不同品种的小麦产量是否有差异

| 小麦品种实验数据        |      |      |      |      |      |
| ----------------------- | ---- | ---- | ---- | ---- | ---- |
| 品种\\\\\\\\\\\\\试验号 | 1    | 2    | 3    | 4    | 5    |
| 1                       | 4350 | 4650 | 4080 | 4275 | 3930 |
| 2                       | 4125 | 3720 | 3810 | 3960 |      |
| 3                       | 4695 | 4245 | 4620 |      |      |

考虑的因素：小麦品种

a个水平效应：3种小麦

$\mu_i-\mu_j$置信度系数（1-$\alpha$）的置信区间
$$
\left[ 
\overline{y}_i-\overline{y}_j-\sqrt{\frac{SS_E}{n-a}}\sqrt{\frac{1}{n_i}+\frac{1}{n_j}}t_{n-a}(\frac{\alpha}{2})
\right]
$$
这个区间包含了0，表明以概率1-$\alpha$断言，即$\mu_i与\mu_{j}$没有显著差异​

这个区间在0的左边，表明以概率1-$\alpha$断言，即$\mu_{i}<\mu_{j}$

这个区间在0的右边，表明以概率1-$\alpha$断言，即$\mu_{i}>\mu_{j}$



#### SPSS实现

在变量视图下，如小麦品种需要三种，打开小麦品种的值，添加1、2、3号（设置分类变量）——分析——比较平均值——单因素方差分析——填入因变量与因子——选项勾选（描述、方差齐性检验、布朗-福赛斯（方差不齐时分析）、韦尔奇（方差不齐时分析）、平均值图、按具体分析排除个案）——事后多重比较勾选（LSD、邓尼特$T_3$）——对比勾选（多项式）



==前提条件：方差齐性检验==

看**显著性>0.05**，说明样本之间的方差是齐性的，所以可以使用方差齐性体条件下对应的检验方法



==ANOVA==

**显著性<0.05 （齐性）拒绝原假设**：认为三种小麦品种（考虑因素）有显著差异，即小麦品种对于亩产量有显著影响，到底哪一种更好，还需要进行两两比较



==平均值相等性稳健检验==

**若显著性>0.05（非齐性）**，参照表格：品均值相等性稳健检验

若参照表格：品均值相等性稳健检验中的显著性任然<0.05，任然存在显著性差异，即说明考虑的因素是存在显著性差异的



==多重比较，LSD：方差齐，邓尼特：方差不齐==

观察**置信区间**

这个区间包含了0，表明以概率1-$\alpha$断言，即$\mu_i与\mu_{j}$没有显著差异​

这个区间在0的左边，表明以概率1-$\alpha$断言，即$\mu_{i}<\mu_{j}$

这个区间在0的右边，表明以概率1-$\alpha$断言，即$\mu_{i}>\mu_{j}$

基于95%置信区间可以得到结论$\mu_3>\mu_1>\mu_2$，即品种3最好，品种1次之，2号最差



==均值图==

直观的可以看出各个因素对因变量的影响程度存在较大差异





## Excel

数据分析——方差分析：单因素方差分析（也可以选择其他的分析）——确定分析区域与输出区域

输出P值如果<0.05，我们拒绝原假设，即因素对变量的影响





## 两因素方差分析模型

因素A和因素B对实验指标的交互效应设想为某一因素的效应，称为这个因素A与这个因素B的交互作用



#### 置信区间

对固定的i和j，$\alpha_i-\alpha_j$置信度系数（1-$\alpha$）的置信区间
$$
\left[ \overline{y}_{i.}-\overline{y}_{t.}-\sqrt{\frac{SS_E}{(a-1)(b-1)}}\sqrt{\frac{2}{b}}t_{(a-1)(b-1)}(\frac{\alpha}{2}),\overline{y}_{i.}-\overline{y}_{t.}+\sqrt{\frac{SS_E}{(a-1)(b-1)}}\sqrt{\frac{2}{b}}t_{(a-1)(b-1)}(\frac{\alpha}{2})\right]
$$
这个区间包含了0，表明以概率1-$\alpha$断言，即$\alpha_i与\alpha_{j}$没有显著差异​

这个区间在0的左边，表明以概率1-$\alpha$断言，即$\alpha_{i}<\alpha_{j}$

这个区间在0的右边，表明以概率1-$\alpha$断言，即$\alpha_{i}>\alpha_{j}$



#### SPSS实现

分析——一般线性模型——==单变量（因变量）==——模型（全因子、把变量移到模型框中）——选项（描述统计、齐性检验）——事后比较（LSD）



==主体间效应检验==

Sig>0.05接受原假设，即各种因素之间的差异对因变量没有显著影响，因此无需进一步检验自变量各水平效应的影响































































































